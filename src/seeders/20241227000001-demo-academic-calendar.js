'use strict';
const { v4: uuidv4 } = require('uuid');

module.exports = {
  async up(queryInterface, Sequelize) {
    // Get an admin user to be the organizer
    const users = await queryInterface.sequelize.query(
      `SELECT id FROM users WHERE role = 'admin' LIMIT 1;`
    );

    const organizerId = users[0].length > 0 ? users[0][0].id : null;

    // 2024-2025 Akademik Yılı Takvimi
    const academicEvents = [
      // Güz Dönemi
      {
        id: uuidv4(),
        title: '2024-2025 Güz Dönemi Başlangıcı',
        description: 'Güz dönemi dersleri başlıyor. Tüm öğrencilerin ders programlarını kontrol etmeleri gerekmektedir.',
        eventType: 'academic',
        startDate: new Date('2024-09-16T09:00:00'),
        endDate: new Date('2024-09-16T17:00:00'),
        location: 'Tüm Kampüs',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Öğrenci İşleri',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'high',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: 'Güz Dönemi Ders Ekleme/Bırakma',
        description: 'Öğrenciler bu tarihler arasında ders ekleme ve bırakma işlemlerini yapabilirler.',
        eventType: 'registration',
        startDate: new Date('2024-09-16T09:00:00'),
        endDate: new Date('2024-09-27T17:00:00'),
        location: 'OBS Sistemi',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Öğrenci İşleri',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'urgent',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: 'Cumhuriyet Bayramı Tatili',
        description: '29 Ekim Cumhuriyet Bayramı nedeniyle resmi tatil.',
        eventType: 'holiday',
        startDate: new Date('2024-10-29T00:00:00'),
        endDate: new Date('2024-10-29T23:59:00'),
        location: 'Tüm Kampüs',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Rektörlük',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'high',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: 'Güz Dönemi Ara Sınavları',
        description: 'Güz dönemi ara sınav haftası. Sınav programını fakülte web sitesinden kontrol ediniz.',
        eventType: 'exam',
        startDate: new Date('2024-11-11T09:00:00'),
        endDate: new Date('2024-11-22T17:00:00'),
        location: 'Sınav Salonları',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Öğrenci İşleri',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'urgent',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: 'Güz Dönemi Final Sınavları',
        description: 'Güz dönemi final sınav haftası başlıyor.',
        eventType: 'exam',
        startDate: new Date('2025-01-06T09:00:00'),
        endDate: new Date('2025-01-17T17:00:00'),
        location: 'Sınav Salonları',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Öğrenci İşleri',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'urgent',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: 'Yarıyıl Tatili',
        description: 'Güz ve Bahar dönemleri arasındaki ara tatil.',
        eventType: 'holiday',
        startDate: new Date('2025-01-20T00:00:00'),
        endDate: new Date('2025-02-07T23:59:00'),
        location: 'Tüm Kampüs',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Rektörlük',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'normal',
        createdAt: new Date(),
        updatedAt: new Date()
      },

      // Bahar Dönemi
      {
        id: uuidv4(),
        title: '2024-2025 Bahar Dönemi Başlangıcı',
        description: 'Bahar dönemi dersleri başlıyor.',
        eventType: 'academic',
        startDate: new Date('2025-02-10T09:00:00'),
        endDate: new Date('2025-02-10T17:00:00'),
        location: 'Tüm Kampüs',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Öğrenci İşleri',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'high',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: 'Bahar Dönemi Ders Kayıt',
        description: 'Bahar dönemi ders kayıt ve ekleme/bırakma dönemi.',
        eventType: 'registration',
        startDate: new Date('2025-02-03T09:00:00'),
        endDate: new Date('2025-02-21T17:00:00'),
        location: 'OBS Sistemi',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Öğrenci İşleri',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'urgent',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: 'Bahar Dönemi Ara Sınavları',
        description: 'Bahar dönemi ara sınav haftası.',
        eventType: 'exam',
        startDate: new Date('2025-04-07T09:00:00'),
        endDate: new Date('2025-04-18T17:00:00'),
        location: 'Sınav Salonları',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Öğrenci İşleri',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'urgent',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: 'Ramazan Bayramı Tatili',
        description: 'Ramazan Bayramı resmi tatili.',
        eventType: 'holiday',
        startDate: new Date('2025-03-30T00:00:00'),
        endDate: new Date('2025-04-02T23:59:00'),
        location: 'Tüm Kampüs',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Rektörlük',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'high',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: '23 Nisan Ulusal Egemenlik ve Çocuk Bayramı',
        description: '23 Nisan resmi tatil.',
        eventType: 'holiday',
        startDate: new Date('2025-04-23T00:00:00'),
        endDate: new Date('2025-04-23T23:59:00'),
        location: 'Tüm Kampüs',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Rektörlük',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'normal',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: '1 Mayıs İşçi Bayramı',
        description: '1 Mayıs Emek ve Dayanışma Günü resmi tatil.',
        eventType: 'holiday',
        startDate: new Date('2025-05-01T00:00:00'),
        endDate: new Date('2025-05-01T23:59:00'),
        location: 'Tüm Kampüs',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Rektörlük',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'normal',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: '19 Mayıs Atatürk\'ü Anma ve Gençlik Spor Bayramı',
        description: '19 Mayıs resmi tatil.',
        eventType: 'holiday',
        startDate: new Date('2025-05-19T00:00:00'),
        endDate: new Date('2025-05-19T23:59:00'),
        location: 'Tüm Kampüs',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Rektörlük',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'normal',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: 'Bahar Dönemi Final Sınavları',
        description: 'Bahar dönemi final sınav haftası.',
        eventType: 'exam',
        startDate: new Date('2025-06-02T09:00:00'),
        endDate: new Date('2025-06-13T17:00:00'),
        location: 'Sınav Salonları',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Öğrenci İşleri',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'urgent',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: 'Kurban Bayramı Tatili',
        description: 'Kurban Bayramı resmi tatili.',
        eventType: 'holiday',
        startDate: new Date('2025-06-06T00:00:00'),
        endDate: new Date('2025-06-09T23:59:00'),
        location: 'Tüm Kampüs',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Rektörlük',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'high',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: 'Mezuniyet Töreni',
        description: '2024-2025 akademik yılı mezuniyet töreni.',
        eventType: 'ceremony',
        startDate: new Date('2025-06-20T14:00:00'),
        endDate: new Date('2025-06-20T18:00:00'),
        location: 'Kongre Merkezi',
        capacity: 2000,
        registeredCount: 0,
        organizer: 'Rektörlük',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'high',
        createdAt: new Date(),
        updatedAt: new Date()
      },

      // Yaz Okulu
      {
        id: uuidv4(),
        title: 'Yaz Okulu Başlangıcı',
        description: 'Yaz okulu dersleri başlıyor.',
        eventType: 'academic',
        startDate: new Date('2025-07-01T09:00:00'),
        endDate: new Date('2025-07-01T17:00:00'),
        location: 'Tüm Kampüs',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Öğrenci İşleri',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'normal',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: 'Yaz Okulu Kayıt Dönemi',
        description: 'Yaz okulu ders kayıtları.',
        eventType: 'registration',
        startDate: new Date('2025-06-23T09:00:00'),
        endDate: new Date('2025-06-27T17:00:00'),
        location: 'OBS Sistemi',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Öğrenci İşleri',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'high',
        createdAt: new Date(),
        updatedAt: new Date()
      },
      {
        id: uuidv4(),
        title: 'Yaz Okulu Final Sınavları',
        description: 'Yaz okulu final sınavları.',
        eventType: 'exam',
        startDate: new Date('2025-08-11T09:00:00'),
        endDate: new Date('2025-08-15T17:00:00'),
        location: 'Sınav Salonları',
        capacity: 10000,
        registeredCount: 0,
        organizer: 'Öğrenci İşleri',
        organizerId: organizerId,
        isActive: true,
        requiresApproval: false,
        priority: 'urgent',
        createdAt: new Date(),
        updatedAt: new Date()
      }
    ];

    await queryInterface.bulkInsert('events', academicEvents);

    console.log(`✅ Seeded ${academicEvents.length} academic calendar events`);
  },

  async down(queryInterface, Sequelize) {
    await queryInterface.bulkDelete('events', {
      eventType: ['academic', 'exam', 'holiday', 'registration', 'ceremony']
    });
  }
};

